size 15 12

defaulthei = 0.36

set lwidth 0.04 hei defaulthei just tc font pspr arrowsize 0.3


include "sub/class.gle"

amove 8 11
class "TrajectoryBase" 

rmove -3 -2
class "Trajectory" "typename A"

rmove 5 0 
class "StochasticTrajectoryBase" "typename T" .75

rmove -8.5 -2
class "Simulated" "typename A"

rmove 5.5 0
class "StochasticTrajectory" "typename A, T" .8

rmove 4.5 0
class "EnsembleTrajectories" "typename T, TE" .8

set lwidth 0.03

set color darkred
join Trajectory.tc -> TrajectoryBase.bl 
join StochasticTrajectoryBase.tc -> TrajectoryBase.br
set color black
join Simulated -> Trajectory.bl
join StochasticTrajectory.tc -> Trajectory.br
join StochasticTrajectory.tr -> StochasticTrajectoryBase.bc
join EnsembleTrajectories.tc -> StochasticTrajectoryBase.bc

amove 0 5.5
set lwidth 0.01 lstyle 4 just rc hei .5*defaulthei
rline 15 0

rmove 0 .25
text C++Utils
rmove 0 -.5
text C++QED

set lwidth 0.04 lstyle 1

rmove -12 -1
class "Master" "int RANK, etc."

rmove 4 0
class "MCWF\_Trajectory" "int RANK, etc."

rmove 4.5 0
class "EnsembleMCWF" "int RANK, etc."

set lwidth 0.03

join Master.tc -> Trajectory.bc 
join "MCWF\_Trajectory".tc -> StochasticTrajectory.bc
join EnsembleMCWF.tc -> EnsembleTrajectories.bc

set hei .4*defaulthei font tt just br

amove ptx(Master.tc) pty(Master.tc)+.05
write "A=DensityOperatorLow<RANK>"

amove ptx("MCWF\_Trajectory".tc) pty("MCWF\_Trajectory".tc)+.05
begin text
      A=StateVectorLow<RANK>
      T=StateVector...<RANK>
end text

amove ptx(EnsembleMCWF.tc) pty(EnsembleMCWF.tc)+.05
begin text
      T =DensityOperator<RANK>
      TE=StateVector....<RANK>
end text


amove ptx("MCWF\_Trajectory".bc) pty("MCWF\_Trajectory".bc)-1.5
class "ProjectingMCWF\_Trajectory" "int RANK, etc." .8

join "ProjectingMCWF\_Trajectory".tc -> "MCWF\_Trajectory".bc 