

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PyCppQED User Guide &mdash; PyCppQED v0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PyCppQED v0.1.1 documentation" href="index.html" />
    <link rel="next" title="PyCppQED Reference" href="reference.html" />
    <link rel="prev" title="PyCppQED’s documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reference.html" title="PyCppQED Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="PyCppQED’s documentation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PyCppQED v0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pycppqed-user-guide">
<span id="user-guide"></span><h1><a class="toc-backref" href="#contents">PyCppQED User Guide</a><a class="headerlink" href="#pycppqed-user-guide" title="Permalink to this headline">¶</a></h1>
<p>This guide explains how to use different features of PyCppQED. For a detailed
documentation about all modules, classes and functions look into the
<a class="reference internal" href="reference.html#reference"><em>PyCppQED Reference</em></a>.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#pycppqed-user-guide" id="id1">PyCppQED User Guide</a><ul>
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#requirements" id="id3">Requirements</a></li>
<li><a class="reference internal" href="#installation" id="id4">Installation</a></li>
<li><a class="reference internal" href="#overview" id="id5">Overview</a></li>
<li><a class="reference internal" href="#usage" id="id6">Usage</a><ul>
<li><a class="reference internal" href="#scripts" id="id7">Scripts</a></li>
<li><a class="reference internal" href="#interactive" id="id8">Interactive</a></li>
<li><a class="reference internal" href="#import-pycppqed" id="id9">Import PyCppQED</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to" id="id10">How to ...</a><ul>
<li><a class="reference internal" href="#split-up-a-c-qed-output-file-into-standard-output-and-state-vectors" id="id11">Split up a C++QED output file into standard output and state vectors</a></li>
<li><a class="reference internal" href="#import-a-c-qed-output-file" id="id12">Import a C++QED output file</a></li>
<li><a class="reference internal" href="#export-python-data-as-mat-file" id="id13">Export python data as <em>.mat</em> file</a></li>
<li><a class="reference internal" href="#generate-arbitrary-initial-conditions" id="id14">Generate arbitrary initial conditions</a></li>
<li><a class="reference internal" href="#export-initial-conditions-as-c-qed-sv-files" id="id15">Export initial conditions as C++QED sv files</a></li>
<li><a class="reference internal" href="#calculate-standard-expectation-values" id="id16">Calculate standard expectation values</a></li>
<li><a class="reference internal" href="#calculate-arbitrary-expectation-values" id="id17">Calculate arbitrary expectation values</a></li>
<li><a class="reference internal" href="#calculate-diagonal-expectation-values" id="id18">Calculate diagonal expectation values</a></li>
<li><a class="reference internal" href="#visualize-pycppqed-objects" id="id19">Visualize PyCppQED objects</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#contents">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>PyCppQED is a python library that helps working with <a class="reference external" href="http://sourceforge.net/projects/cppqed">C++QED</a> - a framework
simulating open quantum dynamics written in C++. Since C++ is not the favorite
programming language of everyone, PyCppQED extends this framework with useful
functionality:</p>
<blockquote>
<div><ul class="simple">
<li>Import C++QED output files into python.</li>
<li>Export this data as <a class="reference external" href="http://www.mathworks.com">Matlab</a> <tt class="docutils literal"><span class="pre">.mat</span></tt> files.</li>
<li>Fast and easy visualization/animation of imported data.</li>
<li>Generating arbitrary initial conditions for C++QED.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="requirements">
<h2><a class="toc-backref" href="#contents">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p><strong>Mandatory:</strong></p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://python.org">Python</a>:</dt>
<dd><p class="first last">The python interpreter. At least version 2.3 but not 3.x.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://scipy.org">NumPy</a>:</dt>
<dd><p class="first last">A numerical package for python. Provides fast N-dimensional array
manipulation.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>Optional:</strong></p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://matplotlib.sourceforge.net">Matplotlib</a>:</dt>
<dd><p class="first last">A plotting library. It is needed for any kind of visualization. (For
3D plots at least 0.99 is needed)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://scipy.org">SciPy</a>:</dt>
<dd><p class="first last">Library providing scientific algorithms. It is needed for exporting
numpy arrays as <tt class="docutils literal"><span class="pre">.mat</span></tt> files and importing <tt class="docutils literal"><span class="pre">.mat</span></tt> files as numpy
arrays. For exporting multidimensional arrays, at least version 0.7 is
needed.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://pygtk.org">PyGTK</a>:</dt>
<dd><p class="first last">GTK bindings for python. It is needed for animations.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#contents">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>First, the c extensions have to be build:</p>
<div class="highlight-python"><pre>$ python setup.py build</pre>
</div>
<p>This creates a directory like <tt class="file docutils literal"><span class="pre">build/lib.linux-x86_64-2.4/pycppqed/</span></tt>.
Either this package can be moved somewhere and used directly (you may want to
add it&#8217;s location to the <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONPATH</span></tt>) or alternatively it can be
installed:</p>
<div class="highlight-python"><pre>$ python setup.py install --prefix=PATH</pre>
</div>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#contents">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>PyCppQED has a strict modular design:</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt>Python classes representing objects used in QED:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="reference.html#module-pycppqed.statevector" title="pycppqed.statevector"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.statevector</span></tt></a> implements state vectors.</li>
<li><a class="reference internal" href="reference.html#module-pycppqed.expvalues" title="pycppqed.expvalues"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.expvalues</span></tt></a> implements classes for working with
expectation values.</li>
<li><a class="reference internal" href="reference.html#module-pycppqed.quantumsystem" title="pycppqed.quantumsystem"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.quantumsystem</span></tt></a> implements classes representing
quantum systems.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Functions for generating some useful initial conditions are in
<a class="reference internal" href="reference.html#module-pycppqed.initialconditions" title="pycppqed.initialconditions"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.initialconditions</span></tt></a>.</p>
</li>
<li><p class="first">Everything that has to do with reading and writing C++QED files is in
the module <a class="reference internal" href="reference.html#module-pycppqed.io" title="pycppqed.io"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.io</span></tt></a>.</p>
</li>
<li><p class="first">Plotting stuff is in <a class="reference internal" href="reference.html#module-pycppqed.visualization" title="pycppqed.visualization"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.visualization</span></tt></a> and animation functions
are implemented in <a class="reference internal" href="reference.html#module-pycppqed.animation" title="pycppqed.animation"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.animation</span></tt></a>.</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#contents">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>PyCppQED can be used either from scripts but also interactively.</p>
<div class="section" id="scripts">
<h3><a class="toc-backref" href="#contents">Scripts</a><a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h3>
<p>Scripts are simple text files with valid python code that can be executed by
invoking the python interpreter with the name of the script as first argument:</p>
<div class="highlight-python"><pre>$ python myscript.py</pre>
</div>
</div>
<div class="section" id="interactive">
<h3><a class="toc-backref" href="#contents">Interactive</a><a class="headerlink" href="#interactive" title="Permalink to this headline">¶</a></h3>
<p>To use python interactively just invoke the interpreter without arguments:</p>
<div class="highlight-python"><pre>$ python
Python 2.6.2 (r262:71600, Aug 17 2009, 10:52:48)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-44)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;</pre>
</div>
<p>A good enhancement to the standard python interpreter is <a class="reference external" href="http://ipython.scipy.org/moin">IPython</a>:</p>
<div class="highlight-python"><pre>$ ipython
Python 2.4.3 (#1, Jul 27 2009, 17:56:30)
Type "copyright", "credits" or "license" for more information.

IPython 0.8.4 -- An enhanced Interactive Python.
?         -&gt; Introduction and overview of IPython's features.
%quickref -&gt; Quick reference.
help      -&gt; Python's own help system.
object?   -&gt; Details about 'object'. ?object also works, ?? prints more.

In [1]:</pre>
</div>
<p>It provides:</p>
<blockquote>
<div><ul>
<li><p class="first"><strong>Tab completion</strong> which allows easy inspection of modules and objects:</p>
<div class="highlight-python"><pre>In [3]: file.re
file.read       file.readinto   file.readline   file.readlines

In [3]: file.read</pre>
</div>
</li>
<li><p class="first"><strong>Easy Inspection</strong>:</p>
<div class="highlight-python"><pre>In [3]: file.read?
Type:           method_descriptor
Base Class:     &lt;type 'method_descriptor'&gt;
String Form:    &lt;method 'read' of 'file' objects&gt;
Namespace:      Python builtin
Docstring:
    read([size]) -&gt; read at most size bytes, returned as a string.

    If the size argument is negative or omitted, read until EOF is
    reached. Notice that when in non-blocking mode, less data than what
    was requested may be returned, even if no size parameter was given.</pre>
</div>
</li>
<li><p class="first"><strong>Many more features ...</strong></p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="import-pycppqed">
<h3><a class="toc-backref" href="#contents">Import PyCppQED</a><a class="headerlink" href="#import-pycppqed" title="Permalink to this headline">¶</a></h3>
<p>To use PyCppQED you have to import it. This is done using an import statement:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pycppqed</span> <span class="kn">as</span> <span class="nn">qed</span>
</pre></div>
</div>
<p>From now on all commands will assume that PyCppQED is already imported with
this statement. Now you are ready to do a lot of fancy stuff with PyCppQED!
The next section gives examples how to achieve common tasks.</p>
</div>
</div>
<div class="section" id="how-to">
<h2><a class="toc-backref" href="#contents">How to ...</a><a class="headerlink" href="#how-to" title="Permalink to this headline">¶</a></h2>
<div class="section" id="split-up-a-c-qed-output-file-into-standard-output-and-state-vectors">
<h3><a class="toc-backref" href="#contents">Split up a C++QED output file into standard output and state vectors</a><a class="headerlink" href="#split-up-a-c-qed-output-file-into-standard-output-and-state-vectors" title="Permalink to this headline">¶</a></h3>
<p>When a C++QED script is invoked using the <em class="xref std std-option">svdc</em> argument, state vectors
are written into the output file between the calculated expectation values.
With PyCppQED it&#8217;s easy to extract the state vectors into own files and
getting a standard C++QED output file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">qed</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">split_cppqed</span><span class="p">(</span><span class="s">&quot;ring.dat&quot;</span><span class="p">,</span> <span class="s">&quot;newring.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This writes the standard output file to <tt class="file docutils literal"><span class="pre">newring.dat</span></tt> and the state
vectors into separate files named <tt class="file docutils literal"><span class="pre">newring_</span><em><span class="pre">time</span></em><span class="pre">.dat.sv</span></tt> where
<tt class="xref std std-token docutils literal"><span class="pre">time</span></tt> is substituted by the time when this state vector was reached.</p>
</div>
<div class="section" id="import-a-c-qed-output-file">
<span id="import2python"></span><h3><a class="toc-backref" href="#contents">Import a C++QED output file</a><a class="headerlink" href="#import-a-c-qed-output-file" title="Permalink to this headline">¶</a></h3>
<p>This is done with the function <a class="reference internal" href="reference.html#pycppqed.io.load_cppqed" title="pycppqed.io.load_cppqed"><tt class="xref py py-func docutils literal"><span class="pre">pycppqed.io.load_cppqed()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span><span class="p">,</span> <span class="n">qs</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load_cppqed</span><span class="p">(</span><span class="s">&quot;ring.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This returns two objects which represent the whole information stored
in the C++QED output file:</p>
<blockquote>
<div><ul class="simple">
<li>A <a class="reference internal" href="reference.html#pycppqed.expvalues.ExpectationValueCollection" title="pycppqed.expvalues.ExpectationValueCollection"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.expvalues.ExpectationValueCollection</span></tt></a> instance which
holds all expectation values calculated by C++QED.</li>
<li>A <a class="reference internal" href="reference.html#pycppqed.quantumsystem.QuantumSystemCompound" title="pycppqed.quantumsystem.QuantumSystemCompound"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.quantumsystem.QuantumSystemCompound</span></tt></a> instance
representing the calculated quantum system. This object also stores a
<a class="reference internal" href="reference.html#pycppqed.statevector.StateVectorTrajectory" title="pycppqed.statevector.StateVectorTrajectory"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.statevector.StateVectorTrajectory</span></tt></a> instance which holds
all calculated state vectors.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="export-python-data-as-mat-file">
<h3><a class="toc-backref" href="#contents">Export python data as <em>.mat</em> file</a><a class="headerlink" href="#export-python-data-as-mat-file" title="Permalink to this headline">¶</a></h3>
<p>If you want to use <a class="reference external" href="http://www.mathworks.com">Matlab</a> or <a class="reference external" href="http://www.gnu.org/software/octave">Octave</a> for further processing of the data
you can use PyCppQED to convert a C++QED output file into a <em>.mat</em> file.
First, we have to load the file like in <a class="reference internal" href="#import2python"><em>Import a C++QED output file</em></a>. The obtained
objects (or only parts of it, or any other array ...) can be saved with
the <tt class="xref py py-func docutils literal"><span class="pre">scipy.io.savemat()</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s">&quot;out.mat&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;evs&quot;</span><span class="p">:</span><span class="n">evs</span><span class="p">,</span> <span class="s">&quot;svs&quot;</span><span class="p">:</span><span class="n">qs</span><span class="o">.</span><span class="n">statevector</span><span class="p">})</span>
</pre></div>
</div>
<p>This file can be used from <a class="reference external" href="http://www.mathworks.com">Matlab</a> and <a class="reference external" href="http://www.gnu.org/software/octave">Octave</a>:</p>
<div class="highlight-matlab"><div class="highlight"><pre><span class="o">&gt;&gt;</span> <span class="n">load</span><span class="p">(</span><span class="s">&#39;out.mat&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">whos</span>
  <span class="n">Name</span>       <span class="n">Size</span>              <span class="n">Bytes</span>  <span class="n">Class</span>     <span class="n">Attributes</span>

  <span class="n">evs</span>       15<span class="n">x175</span>             21000  <span class="n">double</span>
  <span class="n">svs</span>        4<span class="o">-</span><span class="n">D</span>              921600  <span class="n">double</span>    <span class="nb">complex</span>

<span class="o">&gt;&gt;</span> <span class="nb">size</span><span class="p">(</span><span class="n">svs</span><span class="p">)</span>

<span class="nb">ans</span> <span class="p">=</span>

     9    64    10    10


<span class="o">&gt;&gt;&gt;</span> <span class="nb">size</span><span class="p">(</span><span class="n">evs</span><span class="p">)</span>

<span class="nb">ans</span> <span class="p">=</span>

    15   175
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Be aware that old versions of scipy (older than 0.7) can&#8217;t properly export
arrays with more than 2 dimensions!</p>
</div>
</div>
<div class="section" id="generate-arbitrary-initial-conditions">
<h3><a class="toc-backref" href="#contents">Generate arbitrary initial conditions</a><a class="headerlink" href="#generate-arbitrary-initial-conditions" title="Permalink to this headline">¶</a></h3>
<p>In the module <a class="reference internal" href="reference.html#module-pycppqed.initialconditions" title="pycppqed.initialconditions"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.initialconditions</span></tt></a> are some convenient functions
that let you easily create common initial conditions. E.g. to create a
gaussian wave packet in the k-space the following command can be used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv_p</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sv_p</span>
<span class="go">StateVector(128)</span>
</pre></div>
</div>
<p>Or a coherent mode:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv_m</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">coherent</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sv_m</span>
<span class="go">StateVector(20)</span>
</pre></div>
</div>
<p>To obtain initial conditions for a combined quantum system simply use the
<strong>^</strong> operator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">sv_a</span> <span class="o">^</span> <span class="n">sv_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sv</span>
<span class="go">StateVector(128 x 20)</span>
</pre></div>
</div>
<p>It&#8217;s easy to create any other initial condition you can think of, by simply
creating a numpy array with the wanted values and then using the array to
build a <a class="reference internal" href="reference.html#pycppqed.statevector.StateVector" title="pycppqed.statevector.StateVector"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.statevector.StateVector</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span> <span class="c"># An array with 64 values between 0 and 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">statevector</span><span class="o">.</span><span class="n">StateVector</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sv</span>
<span class="go">StateVector(64)</span>
</pre></div>
</div>
</div>
<div class="section" id="export-initial-conditions-as-c-qed-sv-files">
<h3><a class="toc-backref" href="#contents">Export initial conditions as C++QED sv files</a><a class="headerlink" href="#export-initial-conditions-as-c-qed-sv-files" title="Permalink to this headline">¶</a></h3>
<p>Exporting is done with the <a class="reference internal" href="reference.html#pycppqed.io.save_statevector" title="pycppqed.io.save_statevector"><tt class="xref py py-func docutils literal"><span class="pre">pycppqed.io.save_statevector()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">statevector</span><span class="o">.</span><span class="n">StateVector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qed</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">save_statevector</span><span class="p">(</span><span class="s">&quot;mystatevector.sv&quot;</span><span class="p">,</span> <span class="n">sv</span><span class="p">)</span>
</pre></div>
</div>
<p>The created file then looks like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># 0 1</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="p">[</span> <span class="p">(</span><span class="mf">0.267261241912</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.534522483825</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.801783725737</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-standard-expectation-values">
<h3><a class="toc-backref" href="#contents">Calculate standard expectation values</a><a class="headerlink" href="#calculate-standard-expectation-values" title="Permalink to this headline">¶</a></h3>
<p>By <em>standard</em> expectation values we mean values that are also calculated by
C++QED. Automatic calculation for those is implemented in
<a class="reference internal" href="reference.html#module-pycppqed.quantumsystem" title="pycppqed.quantumsystem"><tt class="xref py py-mod docutils literal"><span class="pre">pycppqed.quantumsystem</span></tt></a>. All that has to be done is to first create a
proper quantum system object and then call its <tt class="xref py py-meth docutils literal"><span class="pre">expvalues()</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qs</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">Particle</span><span class="p">(</span><span class="n">sv</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">expvalues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">evs</span>
<span class="go">ExpectationValueCollection(&#39;&lt;k&gt;&#39;, &#39;Var(k)&#39;, &#39;&lt;x&gt;&#39;, &#39;Std(x)&#39;)</span>
<span class="go">ExpectationValueCollection([ 3.2000+0.j,  1.5625+0.j,  0.5000+0.j, 0.4000+0.j])</span>
</pre></div>
</div>
<p>It&#8217;s also possible for combined quantum systems:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv_p</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv_m</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">coherent</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">sv_p</span> <span class="o">^</span> <span class="n">sv_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">quantumsystem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qs</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">QuantumSystemCompound</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">Particle</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">Mode</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">qs</span>
<span class="go">QuantumSystemCompound(Particle(128), Mode(20))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">evs</span>
<span class="go">ExpectationValueCollection(&#39;&lt;k&gt;&#39;, &#39;Var(k)&#39;, &#39;&lt;x&gt;&#39;, &#39;Std(x)&#39;, &#39;&lt;n&gt;&#39;, &#39;Var(n)&#39;, &#39;Re(&lt;a&gt;)&#39;, &#39;Im(&lt;a&gt;)&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">evs</span><span class="p">)</span>
<span class="go">ExpectationValueCollection([  3.19999997e+00+0.j,   1.56250009e+00+0.j,   4.99999995e-01+0.j,  4.00000001e-01+0.j,   3.99999979e+00+0.j,   3.99999747e+00+0.j,   1.99999990e+00+0.j,   6.41996804e-18+0.j])</span>
</pre></div>
</div>
<p>We get a quantum system for free if we load a C++QED output file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span><span class="p">,</span> <span class="n">qs</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load_cppqed</span><span class="p">(</span><span class="s">&quot;ring.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_calc</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">expvalues</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-arbitrary-expectation-values">
<h3><a class="toc-backref" href="#contents">Calculate arbitrary expectation values</a><a class="headerlink" href="#calculate-arbitrary-expectation-values" title="Permalink to this headline">¶</a></h3>
<p>Expectation values for combined systems are calculated in the following way
(Assuming the operator only acts on first subsystem):</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/9b46486dfd0be3cf3df8f51f85d7b47fe8d678a7.png" alt="\langle \Psi | \hat A (k) | \Psi \rangle =
        \sum_{k_1 k_2} \langle k_1 | \hat A (k) | k_2 \rangle
        \sum_m \Psi_{k_1 m}^* \Psi_{k_2 m}" /></p>
</div></div></blockquote>
<p>That means the expectation value is determined by specifying the quantity
<img class="math" src="_images/math/16c0f2a02d6eef59acc0e1a35c6424e4238cedf7.png" alt="A_{k_1 k_2} = \langle k_1 | \hat A (k) | k_2 \rangle"/>. E.g. let&#8217;s
calculate the expectation value of the destruction operator of a combined
system of structure {Particle, Mode}:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv_p</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv_m</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">coherent</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">sv_p</span> <span class="o">^</span> <span class="n">sv_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">a</span>
<span class="go">[[ 0.          1.          0.          0.          0.        ]</span>
<span class="go"> [ 0.          0.          1.41421356  0.          0.        ]</span>
<span class="go"> [ 0.          0.          0.          1.73205081  0.        ]</span>
<span class="go"> [ 0.          0.          0.          0.          2.        ]</span>
<span class="go"> [ 0.          0.          0.          0.          0.        ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ev_a</span> <span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">expvalue</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">ev_a</span>
<span class="go">(0.499933315175-7.96953264544e-18j)</span>
</pre></div>
</div>
<p>The second argument tells the expvalue method that the operator is only working
on the second subsystem. (Python starts counting with 0!)</p>
<p>Let&#8217;s now consider a slightly more complicated example - a combined system of
the form {Particle, Mode, Mode} and let&#8217;s try to calculate the expectation
value for the operator <img class="math" src="_images/math/2a22db8d26a65b67b38458531632426e5c199550.png" alt="T = a_1^\dagger a_2 + a_2^\dagger a_1"/>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv_p</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv_m1</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">coherent</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv_m2</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">coherent</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">sv_p</span> <span class="o">^</span> <span class="n">sv_m1</span> <span class="o">^</span> <span class="n">sv_m2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SV</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">statevector</span><span class="o">.</span><span class="n">StateVector</span> <span class="c"># Define an abbreviation.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1_a</span> <span class="o">=</span> <span class="n">SV</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1_at</span> <span class="o">=</span> <span class="n">SV</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2_a</span> <span class="o">=</span> <span class="n">SV</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2_at</span> <span class="o">=</span> <span class="n">SV</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1_at</span> <span class="o">^</span> <span class="n">m2_a</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">m1_a</span> <span class="o">^</span> <span class="n">m2_at</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sv</span><span class="o">.</span><span class="n">expvalue</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(1.99973315754-1.54328182927e-20j)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-diagonal-expectation-values">
<h3><a class="toc-backref" href="#contents">Calculate diagonal expectation values</a><a class="headerlink" href="#calculate-diagonal-expectation-values" title="Permalink to this headline">¶</a></h3>
<p>If we want to calculate the expectation value of an diagonal operator, we can
use the <a class="reference internal" href="reference.html#pycppqed.statevector.StateVector.diagexpvalue" title="pycppqed.statevector.StateVector.diagexpvalue"><tt class="xref py py-meth docutils literal"><span class="pre">pycppqed.statevector.StateVector.diagexpvalue()</span></tt></a> method. It takes
only the diagonal elements of the operator&#8217;s matrix representation and has
the advantage to be faster and to need less memory than the
<a class="reference internal" href="reference.html#pycppqed.statevector.StateVector.expvalue" title="pycppqed.statevector.StateVector.expvalue"><tt class="xref py py-meth docutils literal"><span class="pre">pycppqed.statevector.StateVector.expvalue()</span></tt></a> method.</p>
<p>A short example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sv</span><span class="o">.</span><span class="n">diagexpvalue</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(3.2+0j)</span>
</pre></div>
</div>
</div>
<div class="section" id="visualize-pycppqed-objects">
<h3><a class="toc-backref" href="#contents">Visualize PyCppQED objects</a><a class="headerlink" href="#visualize-pycppqed-objects" title="Permalink to this headline">¶</a></h3>
<p>There are basically 4 different types of PyCppQED objects which might be
interesting to look at:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="reference.html#pycppqed.statevector.StateVector" title="pycppqed.statevector.StateVector"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.statevector.StateVector</span></tt></a></li>
<li><a class="reference internal" href="reference.html#pycppqed.statevector.StateVectorTrajectory" title="pycppqed.statevector.StateVectorTrajectory"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.statevector.StateVectorTrajectory</span></tt></a></li>
<li><a class="reference internal" href="reference.html#pycppqed.expvalues.ExpectationValueTrajectory" title="pycppqed.expvalues.ExpectationValueTrajectory"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.expvalues.ExpectationValueTrajectory</span></tt></a></li>
<li><a class="reference internal" href="reference.html#pycppqed.expvalues.ExpectationValueCollection" title="pycppqed.expvalues.ExpectationValueCollection"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.expvalues.ExpectationValueCollection</span></tt></a></li>
</ul>
</div></blockquote>
<p>All of them are inheriting from <tt class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></tt> which means you can
easily plot them using <a class="reference external" href="http://matplotlib.sourceforge.net">Matplotlib</a> or <a class="reference external" href="http://gnuplot.info">Gnuplot</a>. However, PyCppQED
implements some functions to let you take a quick look on these objects. All
but the StateVectorTrajectory class have a <tt class="xref py py-meth docutils literal"><span class="pre">plot()</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">coherent</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/graph_coherent.png" src="_images/graph_coherent.png" style="width: 8cm; height: 6cm;" />
<p>To change the x-axis we can pass an array of x-coordinated to the plot method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/graph_gaussian.png" src="_images/graph_gaussian.png" style="width: 8cm; height: 6cm;" />
<p>Since Matplotlib version 0.99 it&#8217;s also possible to draw 3D graphs. This
can be used for combined systems:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sv_p</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">fin</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv_m</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">coherent</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span> <span class="o">=</span> <span class="n">sv_p</span> <span class="o">^</span> <span class="n">sv_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/graph_gaussian&amp;mode.png" src="_images/graph_gaussian&amp;mode.png" style="width: 8cm; height: 6cm;" />
<p>The expectation value classes work equivalent. Maybe also useful is the
function <a class="reference internal" href="reference.html#pycppqed.visualization.compare_expvaluecollections" title="pycppqed.visualization.compare_expvaluecollections"><tt class="xref py py-func docutils literal"><span class="pre">pycppqed.visualization.compare_expvaluecollections()</span></tt></a>. As its
name says it is used to compare two sets of expectation values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span><span class="p">,</span> <span class="n">qs</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load_cppqed</span><span class="p">(</span><span class="s">&quot;ring.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_calc</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">expvalues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qed</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">compare_expvalluecollections</span><span class="p">(</span><span class="n">evs</span><span class="p">,</span> <span class="n">evs_calc</span><span class="p">)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr><td><img alt="expval1" src="_images/graph_expvals1.png" style="width: 5cm; height: 8cm;" /></td>
<td><img alt="expval2" src="_images/graph_expvals2.png" style="width: 5cm; height: 8cm;" /></td>
<td><img alt="expval3" src="_images/graph_expvals3.png" style="width: 5cm; height: 8cm;" /></td>
</tr>
</tbody>
</table>
<p>The only object that is now left, is the
<a class="reference internal" href="reference.html#pycppqed.statevector.StateVectorTrajectory" title="pycppqed.statevector.StateVectorTrajectory"><tt class="xref py py-class docutils literal"><span class="pre">pycppqed.statevector.StateVectorTrajectory</span></tt></a> class. It represents the
time evolution of a state vector. For a 1D system there are already three
dimensions to plot. This would be possible, but an alternative is to use
an animation which will also work for 2D systems.
Animations are implemented as interactive window, but it&#8217;s also possible
to save movies in any format mencoder can write. This functionality
is only very basic and it may need changes on the source code to obtain
professional looking movies. However, here is the code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">qed</span><span class="o">.</span><span class="n">initialconditions</span><span class="o">.</span><span class="n">gaussian</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svt</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="n">t</span><span class="p">)</span> <span class="o">^</span> <span class="n">g</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">0.15</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svt</span><span class="o">.</span><span class="n">animate</span><span class="p">()</span>
</pre></div>
</div>
<p>And here is the example movie: <a class="reference external" href="_static/animation.avi">animation.avi</a></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PyCppQED User Guide</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#scripts">Scripts</a></li>
<li><a class="reference internal" href="#interactive">Interactive</a></li>
<li><a class="reference internal" href="#import-pycppqed">Import PyCppQED</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to">How to ...</a><ul>
<li><a class="reference internal" href="#split-up-a-c-qed-output-file-into-standard-output-and-state-vectors">Split up a C++QED output file into standard output and state vectors</a></li>
<li><a class="reference internal" href="#import-a-c-qed-output-file">Import a C++QED output file</a></li>
<li><a class="reference internal" href="#export-python-data-as-mat-file">Export python data as <em>.mat</em> file</a></li>
<li><a class="reference internal" href="#generate-arbitrary-initial-conditions">Generate arbitrary initial conditions</a></li>
<li><a class="reference internal" href="#export-initial-conditions-as-c-qed-sv-files">Export initial conditions as C++QED sv files</a></li>
<li><a class="reference internal" href="#calculate-standard-expectation-values">Calculate standard expectation values</a></li>
<li><a class="reference internal" href="#calculate-arbitrary-expectation-values">Calculate arbitrary expectation values</a></li>
<li><a class="reference internal" href="#calculate-diagonal-expectation-values">Calculate diagonal expectation values</a></li>
<li><a class="reference internal" href="#visualize-pycppqed-objects">Visualize PyCppQED objects</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">PyCppQED&#8217;s documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="reference.html"
                        title="next chapter">PyCppQED Reference</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/user_guide.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reference.html" title="PyCppQED Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="PyCppQED’s documentation"
             >previous</a> |</li>
        <li><a href="index.html">PyCppQED v0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, Sebastian Krämer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>